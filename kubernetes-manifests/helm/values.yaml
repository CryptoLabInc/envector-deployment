# es2-chart/values.yaml

# Global settings can be defined here
# username is used to mimic the ${USER_NAME} variable from docker-compose

# Overrides for chart name and fullname
nameOverride: ""
fullnameOverride: ""

# External services that this chart depends on.
# These should be running separately.
externalServices:
  metadatadb:
    url: "user=<metadatadb_user> password=<metadatadb_password> host=<metadatadb_host> port=<metadatadb_port> dbname=<metadatadb_database> sslmode=require options='-c search_path=public'"
    schema: "public"
  storage:
    host: <storage_host>
    port: <storage_port>
    user: <storage_user>
    password: <storage_password>
    secure: true
    region: <storage_region>
    create: false
    bucket_name: <storage_bucket>
    hasHealthcheckEndpoint: false # Only for Minio.

imagePullSecrets: []
# Configuration for es2e service
es2e:
  name: es2e
  image:
    repository: cryptolabinc/es2e
    tag: latest
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 50050
    # type: LoadBalancer # Enable this for direct external access without ingress
    # nodePort: 30050 # Optionally specify a nodePort when using NodePort type
    # Optional pod annotations for es2e deployment
    annotations: {}
  logLevel: INFO
  resources: {}
    # limits:
    #   cpu: "1"
    #   memory: "2Gi"
    # requests:
    #   cpu: "0.5"
    #   memory: "1Gi"

# Configuration for es2b service
es2b:
  name: es2b
  image:
    repository: cryptolabinc/es2b
    tag: latest
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 50051
  logLevel: INFO
  env:
    shardSize: 8192
  resources: {}
    # limits:
    #   cpu: "1"
    #   memory: "2Gi"
    # requests:
    #   cpu: "0.5"
    #   memory: "1Gi"

# Configuration for es2o service
es2o:
  name: es2o
  image:
    repository: cryptolabinc/es2o
    tag: latest
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 25121
  command: []
  resources: {}
    # limits:
    #   cpu: "1"
    #   memory: "2Gi"
    # requests:
    #   cpu: "0.5"
    #   memory: "1Gi"

# Configuration for es2c service
es2c:
  name: es2c
  variant: cpu
  image:
    repository: cryptolabinc/es2c
    tag: latest
    pullPolicy: IfNotPresent
  service:
    type: ClusterIP
    port: 25123
  command: []
  replicas: 2
  env:
    useTopk: false
    host: "0.0.0.0"
    threadPoolScale: 4
    numSearchHandler: 10
  resources:
    cpu:
      limits:
        cpu: "4"
      requests:
        cpu: "2"
        memory: "2Gi"
    gpu:
      limits:
        nvidia.com/gpu: 1
        cpu: "8"
      requests:
        cpu: "4"
        memory: "4Gi"

# Ingress configuration
ingress:
  enabled: false
  className: ""
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
    # cert-manager.io/cluster-issuer: letsencrypt-prod
  hosts:
    - host: es2.local
      paths:
        - path: /
          pathType: Prefix
          service:
            name: es2e
            port: 50050
  tls: []
    # - secretName: es2-tls
    #   hosts:
    #     - es2.local
